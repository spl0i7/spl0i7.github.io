<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="Browsers have become major component in everyday computing. We now have web applications for everything. Since we trust our personal data with these apps , A rise of security measures like HTTPS-only">
<meta property="og:type" content="article">
<meta property="og:title" content="Keylogger for Mozilla Firefox">
<meta property="og:url" content="http://ketansingh.net/keylogger-for-mozilla-firefox/index.html">
<meta property="og:site_name" content="Ketansingh.net">
<meta property="og:description" content="Browsers have become major component in everyday computing. We now have web applications for everything. Since we trust our personal data with these apps , A rise of security measures like HTTPS-only">
<meta property="og:updated_time" content="2016-07-22T11:50:08.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Keylogger for Mozilla Firefox">
<meta name="twitter:description" content="Browsers have become major component in everyday computing. We now have web applications for everything. Since we trust our personal data with these apps , A rise of security measures like HTTPS-only">
<meta name="twitter:creator" content="@http://twitter.com/sh_ketan">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Keylogger for Mozilla Firefox</title>
    <!-- styles -->
    <link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/lib/meslo-LG/styles.css">
    <link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss -->
    
    
    <!-- jquery -->
    <script src="/lib/jquery/jquery.min.js"></script>
</head>

<body>
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="http://github.com/spl0i7">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/overview-on-linux-userland-rootkits/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li>
        
        
        <li><a class="icon" href="/sensor-status-twitter-bot-with-nodejs-and-raspberry-pi/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://ketansingh.net/keylogger-for-mozilla-firefox/"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://ketansingh.net/keylogger-for-mozilla-firefox/&text=Keylogger for Mozilla Firefox"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://ketansingh.net/keylogger-for-mozilla-firefox/&title=Keylogger for Mozilla Firefox"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://ketansingh.net/keylogger-for-mozilla-firefox/&is_video=false&description=Keylogger for Mozilla Firefox"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Keylogger for Mozilla Firefox&body=Check out this article: http://ketansingh.net/keylogger-for-mozilla-firefox/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://ketansingh.net/keylogger-for-mozilla-firefox/&title=Keylogger for Mozilla Firefox"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://ketansingh.net/keylogger-for-mozilla-firefox/&title=Keylogger for Mozilla Firefox"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://ketansingh.net/keylogger-for-mozilla-firefox/&title=Keylogger for Mozilla Firefox"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://ketansingh.net/keylogger-for-mozilla-firefox/&title=Keylogger for Mozilla Firefox"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://ketansingh.net/keylogger-for-mozilla-firefox/&name=Keylogger for Mozilla Firefox&description="><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#How-it-works"><span class="toc-number">1.</span> <span class="toc-text">How it works?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Conclusion"><span class="toc-number">2.</span> <span class="toc-text">Conclusion</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Keylogger for Mozilla Firefox
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Ketansingh.net</span>
      </span>
      
    <div class="postdate">
        <time datetime="2016-07-21T08:28:50.000Z" itemprop="datePublished">2016-07-21</time>
    </div>


      
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/malware/">malware</a>, <a class="tag-link" href="/tags/nodejs/">nodejs</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>Browsers have become major component in everyday computing. We now have web applications for everything. Since we trust our personal data with these apps , A rise of security measures like HTTPS-only sites and two-factor authentication can be seen commonplace. But the most easy way to compromise security of a user is through browser plugins.</p>
<p>All the plugins submitted to mozilla or google are verified before it’s put on on their store. But there are problems in this approach. Most plugins aren’t produced by big companies. They’re often small tools an individual person makes to scratch their own itch and releases to the public. These plugins may be perfectly safe when you install them. However, there are companies that offer to buy plugins from their creators for good enough money. This can be tempting developers who created it. The company then takes control over the add-on and modifies it to add tracking script, advertisement scripts and sometimes you know malware.</p>
<p>So, I decided to write a keylogger to find out how easy it is to make one for firefox. In a day I was able to write working code which works as advertised. You can view it on github repo. <a href="https://github.com/spl0i7/firefox-logger" target="_blank" rel="external">Firefox-logger</a>.</p>
<h2 id="How-it-works"><a href="#How-it-works" class="headerlink" title="How it works?"></a>How it works?</h2><p>Plugin itself if written in javascript (as expected) and relies on event listeners provided by firefox sdk. Logging keystroke was undocumented feature hidden inside firefox sdk, which I was able to find out after some digging around.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> observer = <span class="built_in">require</span>(<span class="string">"sdk/keyboard/observer"</span>).observer;</div><div class="line"></div><div class="line">observer.on(<span class="string">'keydown'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</div><div class="line">         <span class="comment">//do something</span></div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<p>What if this API was not provided by firefox sdk? Then we simply could have injected some javascript code using <strong>pagemod</strong> module in sdk and logged in key-presses using</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">document</span>.onkeypress = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">    <span class="comment">// do something</span></div><div class="line">    &#125;;</div></pre></td></tr></table></figure>
<p>plugin also logs opened urls using <strong>tabs</strong> module</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> tabs = <span class="built_in">require</span>(<span class="string">"sdk/tabs"</span>);</div><div class="line"></div><div class="line">tabs.on(<span class="string">'ready'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">tab</span>)</span>&#123;</div><div class="line">	<span class="comment">// do something</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>Key strokes and urls are stored in temporary buffers which is then passed to <strong>network</strong> and <strong>storage</strong> modules every 2 seconds using <strong>setInterval()</strong> . </p>
<p>Network module sends data to log server running in some remote location in json format. We can also use <strong>socket.io</strong> to perform efficient network transaction but in this case it was just a simple code. If network is not there for some reasons then logs are stored locally using firefox’s <strong>simple-storage</strong> module. Since it has limit of 5 MB storage we clear simple-storage data as soon as network transaction is successful.</p>
<p>Server runs on nodejs using express and somewhat weird REST like api :P and logs data into file using a wonderful module called <strong>diskdb</strong> which stores data into json format into a file which is used for read/write operations. diskdb was chosen for being lightweight and easy to use , full fledged attack can also use some real database backend for faster data transaction. </p>
<p>Data can be retrieved back by sending server password in json format and server returns whole json log file.</p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>You can read about on how to setup it on Readme file on github repo. Think twice before installing any kind of browser add-on  and be sure to check what add-ons are installed in your browser regularly . </p>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="http://github.com/spl0i7">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#How-it-works"><span class="toc-number">1.</span> <span class="toc-text">How it works?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Conclusion"><span class="toc-number">2.</span> <span class="toc-text">Conclusion</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://ketansingh.net/keylogger-for-mozilla-firefox/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://ketansingh.net/keylogger-for-mozilla-firefox/&text=Keylogger for Mozilla Firefox"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://ketansingh.net/keylogger-for-mozilla-firefox/&title=Keylogger for Mozilla Firefox"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://ketansingh.net/keylogger-for-mozilla-firefox/&is_video=false&description=Keylogger for Mozilla Firefox"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Keylogger for Mozilla Firefox&body=Check out this article: http://ketansingh.net/keylogger-for-mozilla-firefox/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://ketansingh.net/keylogger-for-mozilla-firefox/&title=Keylogger for Mozilla Firefox"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://ketansingh.net/keylogger-for-mozilla-firefox/&title=Keylogger for Mozilla Firefox"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://ketansingh.net/keylogger-for-mozilla-firefox/&title=Keylogger for Mozilla Firefox"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://ketansingh.net/keylogger-for-mozilla-firefox/&title=Keylogger for Mozilla Firefox"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://ketansingh.net/keylogger-for-mozilla-firefox/&name=Keylogger for Mozilla Firefox&description="><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick='$("#toc-footer").toggle();return false;'><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick='$("#share-footer").toggle();return false;'><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick='$("#nav-footer").toggle();return false;'><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2017 Ketan Singh
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="http://github.com/spl0i7">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    <script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-47868439-2', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Disqus Comments -->


</body>
</html>
